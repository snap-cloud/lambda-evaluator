<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Snap! Build Your Own Blocks. Beta</title>
        <link rel="shortcut icon" href="favicon.ico">
        <meta charset="utf-8">

        <!-- // <script src="lib/jschannel.js"></script> -->
        <script src="lib/jquery-2.1.4.min.js"></script>
        <script src="lib/underscore-min.js"></script>

        <!--<script src='gradingLog.js'></script>-->
        <script src='spriteEventLog.js'></script>
        <script src='scriptAnalysis.js'></script>

        <!-- Moved down to the bottom to have var id. -->
        <script src="snap/morphic.js"></script>
        <script src="snap/widgets.js"></script>
        <script src="snap/blocks.js"></script>
        <script src="snap/threads.js"></script>
        <script src="snap/objects.js"></script>
        <script src="snap/gui.js"></script>
        <script src="snap/paint.js"></script>
        <script src="snap/lists.js"></script>
        <script src="snap/byob.js"></script>
        <script src="snap/xml.js"></script>
        <script src="snap/store.js"></script>
        <script src="snap/locale.js"></script>
        <script src="snap/cloud.js"></script>
        <script src="snap/sha512.js"></script>
        <script src="snap-edx-overrides.js"></script>

        <link rel="stylesheet" type="text/css" href="AG_status_bar.css" />
        <link rel="stylesheet" type="text/css" href="hintstyle.css" />

        <script src="AGAgent.js"></script>
        <script src='feedbackLog.js'></script>
        <script type='text/javascript'>
            var starter_path = "hw2_scaffold.xml";
            // The id is to act as a course identifier.
            // NOTE: FOR NOW YOU ALSO HAVE TO ADD THE ID TO THE BOTTOM OF THE PAGE.
            var courseID = "BJC.2x";  // e.g. "BJCx"
            // Specify a prerequisite task id, should be null if no such requirement.
            var preReqTaskID = null;
            var preReqID = courseID + preReqTaskID;
            // taskID uniquely identifies the task for saving in browser sessionStorage.
            var taskID = "_hw2_scaffold";
            var id = courseID + taskID;
            var isEDX = isEDXurl();
            // if this question is not meant to be graded, change this flag to false
            var graded = true;
            // to hide feedback for this problem, change this flag to false
            var showFeedback = true;
            // to allow for the ability to regrade certain tests, change this flag to true
            var regradeOn = false;
            // Add tests to the outputLog. Function is called by runAGTest(id, outputLog)
            // var testLog;
            function AGTest(outputLog) {

            //NOTES TO YIFAT AND PATRICK:
            // IO tests should be isolated.
            // All getter/setter functions inside anonymous Assert functions.
            // Thanks for all your work :D


            var fb = new FeedbackLog(null, id, 'this is a feedback log test', 0);
            fb.snapWorld = world;

            var chunk_0 = fb.newChunk('Make the "length of longest word in %" block.');

            var lengthExists_0 = function () {
                return spriteContainsBlock("length of longest word in %");
            }

            var tip_0_1 = chunk_0.newTip('Make sure you name your block exactly "length of longest word in %" and place it in the scripting area.',
                'Great job!');

            tip_0_1.newAssertTest(
                lengthExists_0,
                "Testing if the 'length of longest word in %' block is in the scripting area.",
                "The 'length of longest word in %' block is in the scripting area.",
                "Make sure you name your block exactly 'length of longest word in %' and place it in the scripting area.",
                0);

            var tip_0_2 = chunk_0.newTip('Make sure your block works for any valid input.',
                'Great job!');

            tip_0_2.newIOTest('r',  //testClass
                'length of longest word in %',  //blockSpec
                [['dog', 'cat', 'tree', 'my', 'hello']],  //input
                5,  //output
                -1,  //timeout
                true,  //isolated
                0.7);  //points

            tip_0_2.newIOTest('r',  //testClass
                'length of longest word in %',  //blockSpec
                [['hi', 'morning', 'hello']],  //input
                7,  //output
                -1,  //timeout
                true,  //isolated
                0.7);  //points

            // tip_0_2.newIOTest('r',  //testClass
            //     'length of longest word in %',  //blockSpec
            //     [[]],  //input
            //     0,  //output
            //     -1,  //timeout
            //     true,  //isolated
            //     1);  //points

            tip_0_2.newIOTest('r',  //testClass
                'length of longest word in %',  //blockSpec
                [['TheBeautyAndJoyOfComputing']],  //input
                26,  //output
                -1,  //timeout
                true,  //isolated
                0.6);  //points

            var chunk_1 = fb.newChunk('Make the "choose secret word from % with length %" block.');

            var chooseExists_1 = function () {
                return spriteContainsBlock("choose secret word from % with length %");
            }

            var tip_1_1 = chunk_1.newTip('Make sure you name your block exactly "choose secret word from % with length %" and place it in the scripting area.',
                'Great job!');

            tip_1_1.newAssertTest(
                chooseExists_1,
                "Testing if the 'choose secret word from % with length %' block is in the scripting area.",
                "The 'choose secret word from % with length %' block is in the scripting area.",
                "Make sure you name your block exactly 'choose secret word from % with length %' and place it in the scripting area.",
                0);

            var tip_1_2 = chunk_1.newTip('Make sure your block works for general inputs.',
                'Great job!');

            tip_1_2.newIOTest('r',  //testClass
                'choose secret word from % with length %',  //blockSpec
                [['dog', 'cat', 'tree', 'my', 'hello'], 5],  //input
                'hello',  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_1_2.newIOTest('r',  //testClass
                'choose secret word from % with length %',  //blockSpec
                [['dog', 'tree', 'my', 'hello'], 3],  //input
                'dog',  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_1_2.newIOTest('r',  //testClass
                'choose secret word from % with length %',  //blockSpec
                [['dog', 'cat', 'tree', 'my', 'hello'], 4],  //input
                'tree',  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_1_2.newIOTest('r',  //testClass
                'choose secret word from % with length %',  //blockSpec
                [['dog', 'cat', 'tree', 'my', 'hello'], 2],  //input
                'my',  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            var chunk_2 = fb.newChunk('Make the "player won? secret % guesses %" block.');

            var playerWonExists_2 = function () {
                return spriteContainsBlock("player won? secret % guesses %");
            }

            var tip_2_1 = chunk_2.newTip('Make sure you name your block exactly "player won? secret % guesses %" and place it in the scripting area.',
                'Great job!');

            tip_2_1.newAssertTest(
                playerWonExists_2,
                "Testing if the 'player won? secret % guesses %' block is in the scripting area.",
                "The 'player won? secret % guesses %' block is in the scripting area.",
                "Make sure you name your block exactly 'player won? secret % guesses %' and place it in the scripting area.",
                0);

            var tip_2_2 = chunk_2.newTip('Make sure your block works for general inputs.',
                'Great job!');

            tip_2_2.newIOTest('r',  //testClass
                'player won? secret % guesses %',  //blockSpec
                ['banana', ['a', 'b', 'r', 'e', 'n']],  //input
                true,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_2_2.newIOTest('r',  //testClass
                'player won? secret % guesses %',  //blockSpec
                ['mango', ['m', 'a', 'g', 'n', 'o']],  //input
                true,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_2_2.newIOTest('r',  //testClass
                'player won? secret % guesses %',  //blockSpec
                ['apples', ['a', 'b', 'c', 'd', 'e']],  //input
                false,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_2_2.newIOTest('r',  //testClass
                'player won? secret % guesses %',  //blockSpec
                ['ant', ['a', 'n']],  //input
                false,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points


            // var chunk_3 = fb.newChunk('Make the "player lost? lives %" block.');

            // var playerLostExists_3 = function () {
            //     return spriteContainsBlock("player lost? lives %");
            // }

            // var tip_3_1 = chunk_3.newTip('Make sure you name your block exactly "player lost? lives %" and place it in the scripting area.',
            //     'Great job!');

            // tip_3_1.newAssertTest(
            //     playerLostExists_3,
            //     "Testing if the 'player lost? lives %' block is in the scripting area.",
            //     "The 'player lost? lives %' block is in the scripting area.",
            //     "Make sure you name your block exactly 'player lost? lives %' and place it in the scripting area.",
            //     1);

            // var tip_3_2 = chunk_3.newTip('Make sure your block works for general inputs.',
            //     'Great job!');

            // tip_3_2.newIOTest('r',  //testClass
            //     'player lost? lives %',  //blockSpec
            //     [0],  //input
            //     true,  //output
            //     -1,  //timeout
            //     true,  //isolated
            //     1);  //points

            // tip_3_2.newIOTest('r',  //testClass
            //     'player lost? lives %',  //blockSpec
            //     [1],  //input
            //     false,  //output
            //     -1,  //timeout
            //     true,  //isolated
            //     1);  //points

            // tip_3_2.newIOTest('r',  //testClass
            //     'player lost? lives %',  //blockSpec
            //     [3],  //input
            //     false,  //output
            //     -1,  //timeout
            //     true,  //isolated
            //     1);  //points

            var chunk_4 = fb.newChunk('Make the "number of % in %" block.');

            var numberOfExists_4 = function () {
                return spriteContainsBlock("number of % in %");
            }

            var tip_4_1 = chunk_4.newTip('Make sure you name your block exactly "number of % in %" and place it in the scripting area.',
                'Great job!');

            tip_4_1.newAssertTest(
                numberOfExists_4,
                "Testing if the 'number of % in %' block is in the scripting area.",
                "The 'number of % in %' block is in the scripting area.",
                "Make sure you name your block exactly 'number of % in %' and place it in the scripting area.",
                0);

            var tip_4_2 = chunk_4.newTip('Make sure your block works for all valid inputs.',
                'Great job!');

            tip_4_2.newIOTest('r',  //testClass
                'number of % in %',  //blockSpec
                ['b', 'table'],  //input
                1,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_4_2.newIOTest('r',  //testClass
                'number of % in %',  //blockSpec
                ['t', 'turtle'],  //input
                2,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_4_2.newIOTest('r',  //testClass
                'number of % in %',  //blockSpec
                ['s', 'scissors'],  //input
                4,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points

            tip_4_2.newIOTest('r',  //testClass
                'number of % in %',  //blockSpec
                ['r', 'table'],  //input
                0,  //output
                -1,  //timeout
                true,  //isolated
                0.5);  //points


            var chunk_5 = fb.newChunk('Make the "display pattern of % with %" block.');

            var diplayPatternExists_5 = function () {
                return spriteContainsBlock("display pattern of % with %");
            }

            var tip_5_1 = chunk_5.newTip('Make sure you name your block exactly "display pattern of % with %" and place it in the scripting area.',
                'Great job!');

            tip_5_1.newAssertTest(
                diplayPatternExists_5,
                "Testing if the 'display pattern of % with %' block is in the scripting area.",
                "The 'display pattern of % with %' block is in the scripting area.",
                "Make sure you name your block exactly 'display pattern of % with %' and place it in the scripting area.",
                0);

            var tip_5_2 = chunk_5.newTip('Make sure your block works for all valid inputs.',
                'Great job!');

            tip_5_2.newIOTest('r',  //testClass
                'display pattern of % with %',  //blockSpec
                ['tree', ['a', 'b', 'r', 'e']],  //input
                '-ree',  //output
                -1,  //timeout
                true,  //isolated
                0.4);  //points

            tip_5_2.newIOTest('r',  //testClass
                'display pattern of % with %',  //blockSpec
                ['ocean', ['o', 'b', 'r', 'c']],  //input
                'oc---',  //output
                -1,  //timeout
                true,  //isolated
                0.4);  //points

            tip_5_2.newIOTest('r',  //testClass
                'display pattern of % with %',  //blockSpec
                ['pie', ['i']],  //input
                '-i-',  //output
                -1,  //timeout
                true,  //isolated
                0.4);  //points

            tip_5_2.newIOTest('r',  //testClass
                'display pattern of % with %',  //blockSpec
                ['pie', ['o']],  //input
                '---',  //output
                -1,  //timeout
                true,  //isolated
                0.4);  //points

            tip_5_2.newIOTest('r',  //testClass
                'display pattern of % with %',  //blockSpec
                ['horse', ['h', 'e', 'r', 's', 'o']],  //input
                'horse',  //output
                -1,  //timeout
                true,  //isolated
                0.4);  //points


            return fb;
        }
        </script>
        <script src='feedbackLog.js'></script>
        <script src="AGFormatting.js"></script>

        <script type="text/javascript">
        var world, ide;
        window.onload = function () {
            //INITIALIZE UP SNAP
            world = new WorldMorph(document.getElementById('world'));
            ide = new IDE_Morph(false)
            ide.openIn(world);
            // var ide = world.children[0];

            // Reduce Stage Size on initialization
            ide.toggleStageSize(true);

            initializeSnapAdditions(world, id);

            //AUTOGRADER ADDITION -
            //Create a gradingLog and initialize the AG status bar (AGSB).
            //Initialize AGSB button.
            var grade_button = document.getElementById("autograding_button");
            grade_button.addEventListener('click', button_listener);
            var world_canvas = document.getElementById('world');
            world_canvas.addEventListener("mouseup", update_listener);
            // Start Snap Environment Loop
            setInterval(loop, 1);
        };

        function loop() {
            world.doOneCycle();
        }
        </script>
        <script src='feedbackLog.js'></script>
        <script src="AG_EDX.js"></script>
    </head>
    <body style="margin: 0;">
        <canvas id="world" tabindex="1"></canvas>

        <!-- Snap Autograding Button -->
        <div id="autograding_bar">
            <div tabindex="0" class="onclick-menu" id='onclick-menu' style="display:inline-block">
                <span title="Menu">&#9776;</span>
                <div class='hover_darken'></div>
                <nav id="navigation" class="site-navigation" role="navigation">
                    <ul id="dropdown-closed" class="bubble">
                        <!--
                        <li class="menu-item-sub-menu" id="enabled-button">
                            <a id="feedback-button">View Feedback</a>
                        </li>
                        <li class="menu-divider-sub-menu" id='menu-divider'>
                        </li>
                        -->
                        <li class="menu-item-sub-menu" id="enabled-button">
                            <a id="undo-button">Revert To Last Attempt</a>
                        </li>
                        <li class="menu-item-sub-menu" id="enabled-button">
                            <a id="revert-button">Revert To Best Attempt</a>
                        </li>
                        <!--<li class="menu-item-sub-menu" id="enabled-button">
                            <a id="last-submit">Revert To Last edX Submission</a>
                            </li>-->
                        <li class="menu-item-sub-menu" id="enabled-button">
                            <a id="reset-button">Reset</a>
                        </li>
                        <li class="menu-divider-sub-menu" id='menu-divider'>
                        </li>
                        <li class="menu-item-sub-menu" id='enabled-button' onclick="openPopup();">
                            <a id="help-button">Help</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div id="autograding_button" style="display:inline-block;">
                <span></span>
                <div class='hover_darken'></div>
            </div>
            <div id="numtips" style="display:inline-block"></div>
        </div>
        <!-- Snap Autograding Menu -->
        <!-- Autograding Menu Help Button -->
        <div class="overlay is-hidden" id="overlay">
            <p class="help-text" id="full-screen-arrow">&#8600;</p>
            <p class="help-text" id="full-screen-help">
                This full-screen button will pop out the Snap! window.
            </p>
            <p class="help-text" id="menu-item-arrow">&#8599;</p>
            <p class="help-text" id="menu-item-help">The first two menu items will revert your current Snap! state to one of your previous attempts, depending on whether you wish to revert to your last graded attempt or to your best attempt.</br></br>The 'Reset' button will revert to a blank Snap! project, or to a provided starter file if one is given for this problem.</p>
            <p class="help-text" id="ag-button-arrow">&#8593;</p>
            <p class="help-text" id="ag-button-help">Clicking this button will grade your current attempt and send the results to edX.</p>
        </div>

        <div style="display:inline-block" class="view-results" id="circle" onclick="openResults();">
            Results
        </div>
        <div class="overlay is-hidden" id="ag-output">
            <div class="popup-content" id="ag-results">
                <span class="button-close" onclick="closeResults();" id="popup">X</span>
                <!--<p id = "different-feedback"></p>
                    <p id = "edx-submit-different"></p>-->
                <div id="toggle-correct-tests"></div>
                <p id="comment"></p>
            </div>
        </div>
    </div>
    </body>
</html>